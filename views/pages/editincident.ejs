<!DOCTYPE html>
<html lang="en">
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->

<head>
    <% include ../partials/header_.ejs %>
    <style>
        spa {
            font-weight: normal;
            font-style: italic;
        }
        #photos {
            /* Prevent vertical gaps */
            line-height: 0;
            -webkit-column-count: 8;
            -webkit-column-gap: 0px;
            -moz-column-count: 8;
            -moz-column-gap: 0px;
            column-count: 8;
            column-gap: 0px;
        }

        #photos img {
            /* Just in case there are inline attributes */
            width: 100% !important;
            height: auto !important;
        }

        @media (max-width: 1200px) {
            #photos {
                -moz-column-count: 4;
                -webkit-column-count: 4;
                column-count: 4;
            }
        }

        @media (max-width: 1000px) {
            #photos {
                -moz-column-count: 3;
                -webkit-column-count: 3;
                column-count: 3;
            }
        }

        @media (max-width: 800px) {
            #photos {
                -moz-column-count: 2;
                -webkit-column-count: 2;
                column-count: 2;
            }
        }

        @media (max-width: 400px) {
            #photos {
                -moz-column-count: 1;
                -webkit-column-count: 1;
                column-count: 1;
            }
        }
    </style>
</head>

<body class="">
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKDMSK6" height="0" width="0"
            style="display:none;visibility:hidden"></iframe>
    </noscript>
    <div class="wrapper ">
        <% include ../partials/sidebar.ejs %>
        <div class="main-panel">
            <% include ../partials/nav.ejs %>
            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <a href="perpetrator/acdfgstferetebennennen">
                                <div class="card card-stats">
                                    <div class="card-header card-header-rose card-header-icon">
                                        <div class="card-icon">
                                            <i class="material-icons">assignment_ind</i>
                                        </div>
                                        <p class="card-category">Perpetrator</p>
                                        <h3 class="card-title">B. F.</h3>
                                    </div>
                                    <div class="card-footer">
                                    </div>
                                </div>
                            </a>

                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <a href="company/acdfgstferetebennennen">
                                <div class="card card-stats">
                                    <div class="card-header card-header-success card-header-icon">
                                        <div class="card-icon">
                                            <i class="material-icons">location_city</i>
                                        </div>
                                        <p class="card-category">Company</p>
                                        <h3 class="card-title">Mark & Berkley</h3>
                                    </div>
                                    <div class="card-footer">
                                    </div>
                                </div>
                            </a>


                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header card-header-info card-header-text">
                                <div class="card-text">
                                    <h4 class="card-title">Edit Incident</h4>
                                </div>
                            </div>
                            <div class="card-body">
                                <form>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group bmd-form-group">
                                                <label class="bmd-label-floating">Incident Title</label>
                                                <input type="text" class="form-control" value="Lorem ipsum">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group bmd-form-group">
                                                <label class="bmd-label-floating">Date and Time of the incident</label>
                                                <input type="text" class="form-control" value="20th, Jan-2020 | 4:20PM">
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="form-group bmd-form-group">
                                                <label class="bmd-label-floating">Incident Location</label>
                                                <input type="email" class="form-control"
                                                    value="Mountain View, California, United States">
                                            </div>
                                        </div>

                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label>Incident Narration</label>
                                                <div class="form-group bmd-form-group">
                                                    <label class="bmd-label-floating">How the incident happened, what
                                                        transpired and possible
                                                        people as witnesses</label>
                                                    <textarea class="form-control" rows="10">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum
                                        </textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <label>Incident Evidencent Files</label>
                                            <form method="post" enctype="multipart/form-data"
                                                action="http://localhost:3002/api/upload_files" id="add_image_form">
                                                <div class="input-field">
                                                    <!-- <input type="file" name="images" multiple/> -->
                                                    <div class="input-images-1" style="padding-top: .5rem;"
                                                        onchange="{alert(0)}"></div>
                                                </div>
                                                <input type="hidden" name="caseId"
                                                    value="<%= userData.data.caseId %>" />
                                                <input type="hidden" name="incidentId"
                                                    value="<%= userData.data.incidentId %>" />
                                                <div class="row">

                                                    <div class="col-md-12" style="margin-top:10px">
                                                        <section id="photos"></section>
                                                    </div>

                                                    <%
                                                        for(var j = 0; j <= 9; j++) { %>
                                                    <!-- <div class="col-md-1" >
                                                            <img src="img/1.jpg" />
                                                        </div> -->
                                                    <% } %>

                                                    <div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <p>&nbsp;</p>
                                                        <hr
                                                            style="border-top: 1px rgba(156, 39, 176, 0) 0) solid;width:100%;margin-top:10px">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                <label>How do you feel</label>
                                                            </div>
                                                            <div class="col-md-4">
                                                                <div class="form-check bmd-form-group">
                                                                    <label class="form-check-label">
                                                                        <input class="form-check-input" type="radio"
                                                                            name="abusetype" value="sexual_violence"
                                                                            checked="">
                                                                        <p>
                                                                            Good <spa>(lorem ipsum is a placehold)</spa>
                                                                        </p>
                                                                        <span class="circle">
                                                                            <span class="check"></span>
                                                                        </span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4">
                                                                <div class="form-check bmd-form-group">
                                                                    <label class="form-check-label">
                                                                        <input class="form-check-input" type="radio"
                                                                            name="abusetype"
                                                                            value="personal_harrassment">
                                                                        <p>Bad <spa>(lorem ipsum is a placehold)
                                                                            </spa>
                                                                        </p>
                                                                        <span class="circle">
                                                                            <span class="check"></span>
                                                                        </span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4">
                                                                <div class="form-check bmd-form-group">
                                                                    <label class="form-check-label">
                                                                        <input class="form-check-input" type="radio"
                                                                            name="abusetype" value="profesional_abuse">
                                                                        <p>Terrible <spa>(lorem ipsum is a
                                                                                placehold)</spa>
                                                                        </p>
                                                                        <span class="circle">
                                                                            <span class="check"></span>
                                                                        </span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12">
                                                            <a href="" class="btn btn-rose" style="float:right;">Update
                                                                Incident</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                            </div>
                        </div>

                    </div>
                </div>
                <% include ../partials/footer.ejs %>
            </div>
        </div>
        <% <!--include ../partials/theme_bar.ejs--> %>
        <% include ../partials/footer_script.ejs %>
        <script>
            String.prototype.trimRight = function (charlist) {
                if (charlist === undefined)
                    charlist = "\/";

                return this.replace(new RegExp("[" + charlist + "]+$"), "");
            };

            function getRandomSize(min, max) {
                return Math.round(Math.random() * (max - min) + min);
            }

            //$(document).ajaxStart($.blockUI).ajaxStop($.unblockUI);
            $(document).ready(function () {
                setTimeout(function () {
                    var allImages = "";

                    for (var i = 0; i < 16; i++) {
                        console.log(i);
                        var width = getRandomSize(50, 70);
                        var height = getRandomSize(50, 70);
                        allImages += '<img src="https://placekitten.com/' + width + '/' + height +
                            '" alt="pretty kitty">';
                    }

                    $('#photos').append(allImages);
                }, 3000);


                let url = location.href.toLowerCase().trimRight().split("/")
                let caseId = url[4]
                let incidentId = url[5]
                //console.log(url)
                var options = {
                    headers: {
                        "caseid": caseId,
                        "incidentid": incidentId
                    },
                    target: '#output2', // target element(s) to be updated with server response
                    beforeSubmit: showRequest, // pre-submit callback
                    success: showResponse, // post-submit callback
                    resetForm: true

                    // other available options:
                    //url:       url         // override for form's 'action' attribute
                    //type:      type        // 'get' or 'post', override for form's 'method' attribute
                    //dataType:  null        // 'xml', 'script', or 'json' (expected server response type)
                    //clearForm: true        // clear all form fields after successful submit
                    //resetForm: true        // reset the form after successful submit

                    // $.ajax options can be used here too, for example:
                    //timeout:   3000
                };

                // bind to the form's submit event
                $('#add_image_form').submit(function () {
                    // inside event callbacks 'this' is the DOM element so we first
                    // wrap it in a jQuery object and then invoke ajaxSubmit
                    $(this).ajaxSubmit(options);

                    // !!! Important !!!
                    // always return false to prevent standard browser submit and page navigation
                    return false;
                });

                $('.input-images-1').imageUploader({
                    id: "add_incident_image"
                });
                $("#add_incident_image").on("change", function () {
                    // $('#add_image_form').submit();
                    //alert($(this).files.length);
                })
                $('.dropify').dropify();
                // Used events
                var drEvent = $('.dropify-event').dropify();
                drEvent.on('dropify.beforeClear', function (event, element) {
                    return confirm("Do you really want to delete \"" + element.filename + "\" ?");
                });

                drEvent.on('dropify.afterClear', function (event, element) {
                    alert('File deleted');
                });
            });

            function showRequest(formData, jqForm, options) {
                $.blockUI({
                    message: '<h6 style="text-transform:none;"><img src="loader1.gif"  style="height:50px"/> Uploading incident pictures...</h6>'
                });
                // formData is an array; here we use $.param to convert it to a string to display it
                // but the form plugin does this for you automatically when it submits the data
                var queryString = $.param(formData);

                // jqForm is a jQuery object encapsulating the form element.  To access the
                // DOM element for the form do this:
                // var formElement = jqForm[0];

                //alert('About to submit: \n\n' + queryString);

                // here we could return false to prevent the form from being submitted;
                // returning anything other than false will allow the form submit to continue
                return true;
            }

            // post-submit callback
            function showResponse(responseText, statusText, xhr, $form) {
                // for normal html responses, the first argument to the success callback
                // is the XMLHttpRequest object's responseText property

                // if the ajaxSubmit method was passed an Options Object with the dataType
                // property set to 'xml' then the first argument to the success callback
                // is the XMLHttpRequest object's responseXML property

                // if the ajaxSubmit method was passed an Options Object with the dataType
                // property set to 'json' then the first argument to the success callback
                // is the json data object returned by the server

                alert('status: ' + statusText + '\n\nresponseText: \n' + responseText +
                    '\n\nThe output div should have already been updated with the responseText.');
            }
        </script>
</body>

</html>